---
import TimeIcon from "../icons/TimeIcon.astro";
import FormatArtists from "../components/FormatArtists.astro"

import {songs} from "../data/songs"
import type {Song} from "../data/songs"

// calcula la diferencia en dia entre dos fechas
const calculateDateDifference = (date1: Date, date2: Date) => {
  const diffTime = Math.abs(date2.getTime() - date1.getTime());
  const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
  return diffDays;
};

// obtenemos la fecha actual
const currentDate = new Date();
---

<div class="px-6">
  <table class="table-auto text-left min-w-full">
    <thead class="border-b-[1px] border-gray-300/30 z-50">
      <tr class="text-gray-300">
        <th class="font-normal px-0 py-2 text-center whitespace-nowrap">#</th>
        <th class="font-normal px-4 py-2 whitespace-nowrap">Título</th>
        <th class="font-normal px-4 py-2 whitespace-nowrap">Álbum</th>
        <th class="font-normal px-4 py-2 whitespace-nowrap">Fecha en la que se añadio</th>
        <th class="font-normal px-4 py-2 whitespace-nowrap flex justify-center">
          <TimeIcon name="carbon:time" class="inline-block" />
        </th>
      </tr>
    </thead>
    <tbody>
      {
        songs.map((song: Song, index) => (
          <tr class="group hover:bg-gray-500/20">
            <td class="whitespace-nowrap px-0 text-center py-2.5">{index + 1}</td>
            <td class="whitespace-nowrap px-4 py-2.5 flex gap-3 items-center">
              <div class="h-10 w-10">
                <img
                  src={song.bannerImage}
                  alt={song.title}
                  class="rounded object-cover h-full w-full shadow-[5px_0_30px_0px_rgba(0,0,0,0.3)]"
                />
              </div>
              <div class="leading-none">
                <a
                  href="#"
                  class="text-slate-50 group-hover:text-white hover:underline text-base font-medium"
                >
                  {song.title}
                </a>
                <div class="text-sm text-gray-300 group-hover:text-white">
                  <FormatArtists artists={song.artists} />
                </div>
              </div>
            </td>
            <td class="whitespace-nowrap px-4 py-2.5">
              <a
                href="#"
                class="text-gray-300 group-hover:text-white hover:underline text-sm"
              >
                {song.album}
              </a>
            </td>
            <td class="whitespace-nowrap px-4 py-2.5">
              <a
                href="#"
                class="text-gray-300 group-hover:text-white hover:underline text-sm"
              >
                hace {calculateDateDifference(new Date(song.date), currentDate)} dia(s)
              </a>
            </td>
            <td class="whitespace-nowrap text-gray-300 px-4 py-2.5 text-center">
              {song.duration}
            </td>
          </tr>
        ))
      }
    </tbody>
  </table>
</div>

<style>
  thead {
    
  }
</style>